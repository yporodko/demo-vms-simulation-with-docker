# Ansible Inventory
# This file defines all your VMs and groups them logically

all:
  children:
    # MariaDB servers
    mariadb:
      hosts:
        maria-primary:
          ansible_host: 157.180.114.52
        maria-replica:
          ansible_host: 37.27.248.240
          # Override: Use primary's IP address for replication connection
          mariadb_primary_host: "157.180.114.52"

    # PostgreSQL servers
    postgres:
      hosts:
        postgres-primary:
          ansible_host: 46.62.207.138
          # HAProxy backend configuration (use IPs for health checks)
          postgres_primary_host: "46.62.207.138"
          postgres_replica1_host: "37.27.255.157"
          postgres_replica2_host: "65.21.148.130"
        postgres-replica-1:
          ansible_host: 37.27.255.157
          # Override: Use primary's IP address for replication connection
          postgres_primary_host: "46.62.207.138"
        postgres-replica-2:
          ansible_host: 65.21.148.130
          # Override: Use primary's IP address for replication connection
          postgres_primary_host: "46.62.207.138"

    # HAProxy load balancer
    loadbalancers:
      hosts:
        postgres-balancer:
          ansible_host: 65.21.148.130  # TODO: Get correct IP

    # Web servers
    webservers:
      hosts:
        nginx:
          ansible_host: 157.180.118.98
          # Backend servers for load balancing
          nginx_backend_servers:
            - { name: "app-1", address: "37.27.203.40", port: 8080, weight: 1 }
            - { name: "app-2", address: "46.62.196.149", port: 8080, weight: 1 }
        app-1:
          ansible_host: 37.27.203.40
        app-2:
          ansible_host: 46.62.196.149

    # VoIP servers
    voip:
      hosts:
        asterisk-1:
          ansible_host: 46.62.200.187
        asterisk-2:
          ansible_host: 95.216.205.250
        asterisk-balancer:
          ansible_host: 37.27.35.37

    # VPN server
    vpn:
      hosts:
        openvpn:
          ansible_host: 77.42.24.220

  # Global variables for all hosts
  vars:
    ansible_user: root
    ansible_ssh_private_key_file: ~/.ssh/redi_test_key
    ansible_python_interpreter: /usr/bin/python3
